webpackJsonp([1],{"0jv5":function(t,e){},NHnr:function(t,e,a){"use strict";function s(t){a("ogiM")}function i(t){a("tR2c")}function n(t){a("s3X/")}function r(t){a("RC7b")}function l(t){a("cRlz")}function o(t){a("0jv5")}Object.defineProperty(e,"__esModule",{value:!0});var c=a("1P6t"),u={name:"app"},d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("keep-alive",[t.$route.meta.keepAlive?a("router-view"):t._e()],1),t._v(" "),t.$route.meta.keepAlive?t._e():a("router-view")],1)},f=[],p={render:d,staticRenderFns:f},_=p,h=a("/Xao"),m=s,v=h(u,_,!1,m,null,null),k=v.exports,L=a("zO6J"),V=a("aA9S"),g=a.n(V),y={name:"vueSku",props:{skuData:{type:Object,required:!0},options:{type:Object}},watch:{skuData:function(){this.updateValue(),this.initSku(),this.initStatus()}},data:function(){return{params:{},defaultParams:{},attrListName:"format_list",skuListName:"sku_sale_list",attrListKeyName:"name",attrListKeyId:"id",attrListValueName:"name",attrListValueId:"id",attrListValueEachKey:"format_val_list",attrListValue:[],skuListValue:[],skuListValueName:"format_val_name",skuListValueId:"format_val_id",skuName:"stock_price_list",splitStr:";",selectedSkuInfo:"",SKUResult:{}}},mounted:function(){g()(this.params,this.defaultParams,this.options)},methods:{isSelectAll:function(){var t=this,e=this.attrListValue.length,a=0,s=[];return this.attrListValue.forEach(function(e){var i=!1;e[t.attrListValueEachKey].forEach(function(e){!0===e.selected&&(s.push(e[t.attrListValueId]),i=!0)}),i&&a++}),a>=e&&(this.selectedSkuInfo=this.skuListValue.filter(function(e){return e[t.skuListValueId]===s.join(t.splitStr)})[0],console.warn(this.selectedSkuInfo,"选择的SKU信息为"),!0)},attrStatus:function(t){return{status:!t.disabled,"status disabled":t.disabled,selected:t.selected&&!t.disabled}},updateValue:function(){this.attrListValue=this.skuData[this.attrListName].map(function(t){return t.format_val_list.map(function(t){t.disabled=!1,t.selected=!1}),t}),this.skuListValue=this.skuData[this.skuListName]},initSku:function(){for(var t=this,e=this.getObjKeys(this.skuListValue),a=0;a<e.length;a++){var s;!function(a){var i=e[a],n=t.skuListValue.findIndex(function(e){return e[t.skuListValueId]===i}),r=n>-1?t.skuListValue[n][t.skuName]:{},l=i.split(t.splitStr);l.sort(function(t,e){return parseInt(t)-parseInt(e)}),s=t.combInArray(l);for(var o=0;o<s.length;o++)t.add2SKUResult(s[o],r);t.SKUResult[l.join(t.splitStr)]=r}(a)}console.log(this.SKUResult,"this.SKUResult")},initStatus:function(){var t=this;this.attrListValue.forEach(function(e,a){e[t.attrListValueEachKey].map(function(e,s){t.SKUResult[e[t.attrListValueId]]||(t.attrListValue[a][t.attrListValueEachKey][s].disabled=!0)})})},getObjKeys:function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var a in t)t[a][this.skuListValueId]&&(e[e.length]=t[a][this.skuListValueId]);return e},combInArray:function(t){if(!t||!t.length)return[];for(var e=t.length,a=[],s=1;s<e;s++)for(var i=this.getCombFlags(e,s);i.length;){for(var n=i.shift(),r=[],l=0;l<e;l++)n[l]&&r.push(t[l]);a.push(r)}return a},getCombFlags:function(t,e){if(!e||e<1)return[];for(var a,s=[],i=[],n=!0,r=0;r<t;r++)i[r]=r<e?1:0;for(s.push(i.concat());n;){a=0;for(var l=0;l<t-1;l++){if(1===i[l]&&0===i[l+1]){for(var o=0;o<l;o++)i[o]=o<a?1:0;i[l]=0,i[l+1]=1;var c=i.concat();s.push(c),-1===c.slice(-e).join("").indexOf("0")&&(n=!1);break}1===i[l]&&a++}}return s},add2SKUResult:function(t,e){var a=t.join(this.splitStr);this.SKUResult[a]||(this.SKUResult[a]={})},selectClick:function(t,e,a){var s=this;if(t.disabled)return!1;this.attrListValue[e][this.attrListValueEachKey][a].selected=!t.selected,this.attrListValue[e][this.attrListValueEachKey]=this.attrListValue[e][this.attrListValueEachKey].map(function(e){return t[s.attrListValueId]!==e[s.attrListValueId]&&(e.selected=!1),e}),this.isSelectAll();var i=this.getSelected();if(i.length){var n=[];i.forEach(function(t){n.push(+t[s.attrListKeyId])}),n.sort(function(t,e){return parseInt(t)-parseInt(e)}),this.attrListValue.forEach(function(t,e){t[s.attrListValueEachKey].forEach(function(a,i){if(!a.selected){var r=[];t[s.attrListValueEachKey].forEach(function(t){t.selected&&r.push(t)});var l=[];if(r.length)for(var o=+r[0][s.attrListKeyId],c=0;c<n.length;c++)n[c]!==o&&l.push(n[c]);else l=n.concat();l=l.concat(+a[s.attrListKeyId]),l.sort(function(t,e){return parseInt(t)-parseInt(e)}),s.SKUResult[l.join(s.splitStr)]?s.attrListValue[e][s.attrListValueEachKey][i].disabled=!1:(s.attrListValue[e][s.attrListValueEachKey][i].disabled=!0,s.attrListValue[e][s.attrListValueEachKey][i].selected=!1)}})})}else this.attrListValue.forEach(function(t,e){t[s.attrListValueEachKey].forEach(function(t,a){s.SKUResult[t[s.attrListValueId]]?s.attrListValue[e][s.attrListValueEachKey][a].disabled=!1:(s.attrListValue[e][s.attrListValueEachKey][a].disabled=!0,s.attrListValue[e][s.attrListValueEachKey][a].selected=!1)})})},getSelected:function(){var t=this,e=[];return this.attrListValue.forEach(function(a){a[t.attrListValueEachKey].forEach(function(t){!0===t.selected&&e.push(t)})}),e}}},b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vue-sku"},t._l(t.attrListValue,function(e,s){return a("div",{key:e.key,staticClass:"attrWrap"},[a("h1",{staticClass:"attrTitle"},[t._v(t._s(e[t.attrListKeyName]))]),t._v(" "),a("div",{staticClass:"attrValue"},t._l(e[t.attrListValueEachKey],function(e,i){return a("input",{key:e.key,class:t.attrStatus(e),attrs:{type:"button","data-attrid":e[t.attrListValueId],disabled:e.disabled,value:e[t.attrListValueName]},on:{click:function(a){t.selectClick(e,s,i)}}})}))])}))},E=[],S={render:b,staticRenderFns:E},K=S,w=a("/Xao"),I=i,C=w(y,K,!1,I,"data-v-4a1df416",null),R=C.exports,x={format_list:[{id:"1",name:"机身颜色",format_val_list:[{id:"110",name:"银色"},{id:"111",name:"黄色"},{id:"112",name:"黑色"},{id:"113",name:"玫瑰金"}]},{id:"2",name:"套餐类型",format_val_list:[{id:"210",name:"官方标配"},{id:"211",name:"套餐二"}]},{id:"3",name:"机身内存",format_val_list:[{id:"310",name:"16GB"},{id:"311",name:"64GB"},{id:"312",name:"128GB"}]},{id:"4",name:"版本类型",format_val_list:[{id:"410",name:"港澳台"},{id:"411",name:"美国"},{id:"412",name:"欧洲"},{id:"413",name:"日本"},{id:"414",name:"中国大陆"}]}],sku_sale_list:[{sku_sale_id:"66",format_val_id:"110;210;311;414",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"589.00",child_price:"579.00",date:"2017-11-17",stock:"14"},{adult_price:"589.00",child_price:"579.00",date:"2017-11-18",stock:"5"}]},{sku_sale_id:"67",format_val_id:"111;211;310;414",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"5189.00",child_price:"5279.00",date:"2017-11-17",stock:"14"},{adult_price:"5829.00",child_price:"579.00",date:"2017-11-18",stock:"5"}]},{sku_sale_id:"68",format_val_id:"112;210;312;413",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"5849.00",child_price:"5.00",date:"2017-11-17",stock:"1"},{adult_price:"589.00",child_price:"579.00",date:"2017-11-18",stock:"2"}]},{sku_sale_id:"69",format_val_id:"113;210;311;412",sale_unit:"0",adult_selected:"1",child_selected:"0",baby_selected:"0",is_date:"1",sku_id:"870",is_control:"0",is_digital_stock:"1",sale_id:"34",format_val_name:"销售写真",stock_price_list:[{adult_price:"581.00",child_price:"572.00",date:"2017-11-12",stock:"10"},{adult_price:"589.00",child_price:"579.00",date:"2017-11-13",stock:"9"}]}],error_code:"0000",error_msg:"OK"},$=x,D={name:"HelloWorld",data:function(){return{skuData:{}}},components:{vueSku:R},mounted:function(){this.getSku()},methods:{getSku:function(){var t=this;setTimeout(function(){t.skuData={format_list:$.format_list,sku_sale_list:$.sku_sale_list}},2e3)},pay:function(){this.$refs.sku.isSelectAll()||alert("请选择商品")},format:function(){console.dir(this.skuData)}}},j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("vue-sku",{ref:"sku",attrs:{skuData:t.skuData}}),t._v(" "),a("p",{staticStyle:{padding:"20px"}}),t._v(" "),a("input",{attrs:{type:"button",value:"去支付"},on:{click:t.pay}}),t._v(" "),a("input",{attrs:{type:"button",value:"console SKU数据格式"},on:{click:t.format}})],1)},N=[],U={render:j,staticRenderFns:N},A=U,T=a("/Xao"),O=n,F=T(D,A,!1,O,"data-v-caecac38",null),X=F.exports,M=a("rn78"),B={name:"pull2Detail",props:{},data:function(){return{showDetail:!1,params:{bottom:30,wrapper:{},content1:{status:0}}}},mounted:function(){var t=this;this.$nextTick(function(){var e={probeType:3,disableMouse:!0};t.scroll=new M.a(t.$refs.wrapper,e),g()(t.params.content1,t.getRect(t.$refs.wrapper.querySelector(".content1"))),g()(t.params.wrapper,t.getRect(t.$refs.wrapper)),console.log(t.params.content1,"content1"),console.log(t.params.wrapper,"wrapper"),t.scroll.on("scroll",function(e){console.log(e);var a=Math.abs(e.y)+t.params.wrapper.height-t.params.content1.height;a<=t.params.bottom&&a>0?t.params.content1.status=1:a>t.params.bottom&&(t.params.content1.status=2),t.params.content1.height+e.y>30&&console.log("to top")}),t.scroll.on("touchEnd",function(e){t.params.content1.status=0,Math.abs(e.y)+t.params.wrapper.height-t.params.content1.height>t.params.bottom&&(t.showDetail=!0,t.$nextTick(function(){t.scroll.refresh(),t.scroll.scrollToElement(t.$refs.wrapper1,1e3),t.initDetail()}),console.log("dist"))}),t.scroll.on("scrollEnd",function(e){t.params.content1.status=0})})},methods:{initDetail:function(){this.$nextTick(function(){})},getRect:function(t){if(t instanceof window.SVGElement){var e=t.getBoundingClientRect();return{top:e.top,left:e.left,width:e.width,height:e.height}}return{top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight}}}},H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"detail",staticClass:"detail"},[a("div",{ref:"wrapper",staticClass:"wrapper"},[a("div",{staticClass:"content1"},[a("ul",t._l(50,function(e){return a("li",{key:e},[t._v(t._s(e))])})),t._v(" "),a("div",{staticClass:"scrolltips"},[a("div",{staticClass:"pull-notice-down mui-flex align-center"},[a("i",{staticClass:"loading"}),t._v(" "),t._m(0,!1,!1),t._v(" "),0==t.params.content1.status?a("span",{staticClass:"txt fixed"},[t._v("继续拖动，查看详情")]):1==t.params.content1.status?a("span",{staticClass:"txt fixed"},[t._v("上拉切换到下一屏")]):2==t.params.content1.status?a("span",{staticClass:"txt fixed"},[t._v("释放切换到下一屏")]):t._e(),t._v(" "),t._m(1,!1,!1)])]),t._v(" "),t.showDetail?a("div",{ref:"wrapper1",staticClass:"wrapper1"},[a("div",{staticClass:"content2"},[a("ul",t._l(50,function(e){return a("li",{key:e},[t._v(t._s("详情:"+e))])}))])]):t._e()])])])},G=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cell"},[a("hr")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cell"},[a("hr")])}],P={render:H,staticRenderFns:G},W=P,z=a("/Xao"),q=r,J=z(B,W,!1,q,"data-v-34c65e86",null),Q=J.exports,Y={name:"detail2List",props:{},watch:{},data:function(){return{list:[]}},mounted:function(){console.log("mounted")},activated:function(){var t=this;setTimeout(function(){for(var e=0;e<1e3;e++)t.list.push(e);console.log("activated")},2e3)},methods:{}},Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail2List"},[a("ul",t._l(t.list,function(e){return a("li",{key:e},[a("router-link",{attrs:{to:{name:"detail"}}},[t._v(t._s(e))])],1)}))])},tt=[],et={render:Z,staticRenderFns:tt},at=et,st=a("/Xao"),it=l,nt=st(Y,at,!1,it,"data-v-b91a995e",null),rt=nt.exports,lt={name:"detail2List",props:{},watch:{},data:function(){return{}},mounted:function(){},methods:{}},ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail2List"},[a("ul",t._l(2,function(e){return a("li",{key:e},[t._v(t._s(e))])})),t._v(" "),a("span",{on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")])])},ct=[],ut={render:ot,staticRenderFns:ct},dt=ut,ft=a("/Xao"),pt=o,_t=ft(lt,dt,!1,pt,"data-v-db6e47fc",null),ht=_t.exports;c.a.use(L.a);var mt=new L.a({routes:[{path:"/",name:"HelloWorld",component:X},{path:"/d",name:"pull2Detail",component:Q},{path:"/detail2List",name:"detail2List",component:rt,meta:{keepAlive:!0}},{path:"/detail",name:"detail",component:ht}],scrollBehavior:function(t,e,a){console.log(a)}});c.a.config.productionTip=!1,new c.a({el:"#app",router:mt,template:"<App/>",components:{App:k}})},RC7b:function(t,e){},cRlz:function(t,e){},ogiM:function(t,e){},"s3X/":function(t,e){},tR2c:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.5ceb597a319d716a6561.js.map